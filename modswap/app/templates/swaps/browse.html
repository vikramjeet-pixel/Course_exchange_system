{% extends "base.html" %}
{% block content %}
<div class="flex items-center justify-between">
  <h2 class="text-2xl font-semibold">Browse swap requests</h2>
  <a href="/swaps/create" class="px-4 py-2 rounded bg-blue-600 text-white">Create request</a>
</div>

<form method="get" action="/swaps" class="mt-4 flex gap-2">
  <input name="q" value="{{ q }}" class="flex-1 border rounded px-3 py-2" placeholder="Search by code, name, department" />
  <button class="px-4 py-2 rounded bg-gray-900 text-white">Search</button>
</form>

<div class="mt-4 grid md:grid-cols-2 gap-4">
  {% for s in swaps %}
  <div class="bg-white border rounded p-4">
    <div class="flex items-center justify-between">
      <div class="text-gray-700">{{ s.user.email }}</div>
      <div class="text-xs px-2 py-1 rounded bg-gray-100">{{ s.status }}</div>
    </div>
    <div class="mt-3">
      <div class="text-sm font-medium">Giving</div>
      <div class="mt-1 flex flex-wrap gap-2">
        {% for m in s.giving %}
          <span class="px-2 py-1 rounded bg-blue-50 text-blue-700 text-sm border border-blue-200">{{ m.code }}</span>
        {% endfor %}
      </div>
    </div>
    <div class="mt-3">
      <div class="text-sm font-medium">Wanting</div>
      <div class="mt-1 flex flex-wrap gap-2">
        {% for m in s.wanting %}
          <span class="px-2 py-1 rounded bg-emerald-50 text-emerald-700 text-sm border border-emerald-200">{{ m.code }}</span>
        {% endfor %}
      </div>
    </div>
    <div class="mt-4 flex justify-end">
      <a href="/chat" class="px-3 py-1.5 rounded border">Message</a>
    </div>
  </div>
  {% else %}
  <div class="md:col-span-2 bg-white border rounded p-6">
    <div class="font-medium">No swaps yet</div>
    <div class="text-gray-700 mt-2">Be the first to post a swap request.</div>
    <a href="/swaps/create" class="mt-4 inline-block px-4 py-2 rounded bg-blue-600 text-white">Create request</a>
  </div>
  {% endfor %}
</div>
{% endblock %}